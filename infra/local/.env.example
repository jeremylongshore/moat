# Moat Local Development Environment Variables
# Copy this file to .env and edit as needed.
#   cp infra/local/.env.example infra/local/.env
#
# These values are safe defaults for local/docker-compose use only.
# Never commit a .env file with real secrets.

# ---------------------------------------------------------------------------
# Postgres
# ---------------------------------------------------------------------------
POSTGRES_DB=moat
POSTGRES_USER=moat
POSTGRES_PASSWORD=moat_dev

# Full async URL (used by FastAPI services)
DATABASE_URL=postgresql+asyncpg://moat:moat_dev@postgres:5432/moat

# Sync URL (used by Alembic migrations)
DATABASE_SYNC_URL=postgresql+psycopg2://moat:moat_dev@postgres:5432/moat

# ---------------------------------------------------------------------------
# Redis
# ---------------------------------------------------------------------------
REDIS_URL=redis://redis:6379/0

# ---------------------------------------------------------------------------
# Service URLs (internal docker-compose hostnames)
# ---------------------------------------------------------------------------
CONTROL_PLANE_URL=http://control-plane:8001
GATEWAY_URL=http://gateway:8002
TRUST_PLANE_URL=http://trust-plane:8003
MCP_SERVER_URL=http://mcp-server:8004

# ---------------------------------------------------------------------------
# Signing / Verification
# ---------------------------------------------------------------------------
# Secret used to sign verification receipts. Change in any real environment.
MOAT_SIGNING_SECRET=dev-signing-secret-change-me

# ---------------------------------------------------------------------------
# Slack Adapter (Phase 2)
# ---------------------------------------------------------------------------
# Bot User OAuth Token from https://api.slack.com/apps → OAuth & Permissions
# Required scopes: chat:write
# Leave empty to skip Slack integration (StubAdapter will be used instead)
SLACK_BOT_TOKEN=

# ---------------------------------------------------------------------------
# Auth (stub for local dev – replace with real OIDC in production)
# ---------------------------------------------------------------------------
MOAT_AUTH_DISABLED=true
MOAT_JWT_SECRET=dev-jwt-secret-change-me
MOAT_JWT_ALGORITHM=HS256

# ---------------------------------------------------------------------------
# Rate Limiting
# ---------------------------------------------------------------------------
# Requests per minute per tenant
RATE_LIMIT_RPM=60

# ---------------------------------------------------------------------------
# Logging
# ---------------------------------------------------------------------------
LOG_LEVEL=INFO
LOG_FORMAT=json

# ---------------------------------------------------------------------------
# Web3 / IRSB (on-chain receipts and ERC-8004)
# ---------------------------------------------------------------------------
# Alchemy RPC URL for Sepolia (shared by IRSB receipt hook, ERC-8004, ERC-6551)
# Get a free key at https://dashboard.alchemy.com/
IRSB_RPC_URL=https://eth-sepolia.g.alchemy.com/v2/YOUR_ALCHEMY_KEY

# Per-module overrides (optional — fall back to IRSB_RPC_URL → SEPOLIA_RPC_URL)
# ERC8004_RPC_URL=
# ERC6551_RPC_URL=

# Scout agent identity
SCOUT_AGENT_ID=1319
SCOUT_SOLVER_ADDRESS=0x83Be08FFB22b61733eDf15b0ee9Caf5562cd888d

# Dry-run mode (set to false when signing key is configured)
IRSB_DRY_RUN=true

# RPC domain allowlist for Web3 adapter (comma-separated)
# WEB3_RPC_DOMAIN_ALLOWLIST=eth-sepolia.g.alchemy.com,base-sepolia.g.alchemy.com,eth-mainnet.g.alchemy.com

# ---------------------------------------------------------------------------
# Environment tag (local | dev | staging | prod)
# ---------------------------------------------------------------------------
MOAT_ENV=local
